<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: probability | R)Y)]]></title>
  <link href="http://r9y9.github.io/blog/categories/probability/atom.xml" rel="self"/>
  <link href="http://r9y9.github.io/"/>
  <updated>2013-12-02T00:54:04+09:00</updated>
  <id>http://r9y9.github.io/</id>
  <author>
    <name><![CDATA[Ryuichi Yamamoto]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Multinomial distributionとCategorical distributionの違い]]></title>
    <link href="http://r9y9.github.io/blog/2013/07/31/multinomial-categorical-diff/"/>
    <updated>2013-07-31T22:51:00+09:00</updated>
    <id>http://r9y9.github.io/blog/2013/07/31/multinomial-categorical-diff</id>
    <content type="html"><![CDATA[<p>些細な違いなんだけど調べたのでメモ。Multinomial distributionは多項分布のこと。Categorical distributionは、一般的な日本語表現が見つからなかった（なのでタイトルは英語）。打つのが大変なので、以下カテゴリカル分布と書く。</p>

<p>結論としては、多項分布のn=1の特殊な場合がカテゴリカル分布ですよってこと。以下少しまとめる。</p>

<p>分布を仮定する離散変数をカテゴリと呼ぶとして、</p>

<ul>
<li>多項分布は、n回試行したときに各カテゴリが何回出るかを表す確率分布</li>
<li>多項分布は、二項分布を多カテゴリに一般化したもの</li>
<li>カテゴリカル分布は、多項分布のn=1の場合に相当する</li>
<li>カテゴリカル分布は、ベルヌーイ分布を多カテゴリに一般化したもの</li>
</ul>


<p>以上</p>

<p>nokunoさんによるこの記事→ <a href="http://d.hatena.ne.jp/nokuno/20111006/1317853653">多項分布の最尤推定</a> は、多項分布というよりカテゴリカル分布の話。本文には書いてあるけどね。あと最尤推定の結果はどちらにしろ同じなんだけどね</p>

<h2>導出メモ</h2>

<p>一応最尤推定をやってみる。前回のナイーブベイズのメモの時は省略したので。入力の変数を$Y = {y_n}_{n=1}^{N}$とする。</p>

<h3>カテゴリカル分布</h3>

<p><script type="math/tex; mode=display">
\begin{align}
p(l) = \pi<em>{l}, \hspace{2mm} \sum</em>{l=1}^{L}\pi<em>{l} = 1
\end{align}
</script>
ここで、$\pi</em>{l}$がパラメータ、lはカテゴリの番号</p>

<h3>最尤推定</h3>

<p>尤度関数を立てて、最大化することでパラメータを求める。各データは独立に生起すると仮定すると、尤度関数は以下のようになる。</p>

<p><script type="math/tex; mode=display">
\begin{align}
L(Y; \theta) = \prod<em>{n=1}^{N} \pi</em>{y_{n}}
\end{align}
</script>
$\theta$はパラメータの集合ということで。</p>

<p>ラベルlの出現回数を$N_{l} = \sum_{n=1}^{N} \delta (y_{n} = l)$とすると、次のように書き直せる。</p>

<p><script type="math/tex; mode=display">
\begin{align}
L(Y; \theta) = \prod<em>{l=1}^{L}\pi</em>{l}^{N_{l}}
\end{align}
</script></p>

<p>よって、対数尤度は以下のようになる。
<script type="math/tex; mode=display">
\begin{align}
\log L(Y; \theta) = \sum<em>{l=1}^{L} N</em>{l}\log \pi_{l}
\end{align}
</script></p>

<h3>ラグランジュの未定乗数法で解く</h3>

<p>nokunoさんの記事の通りだけど、一応手でも解いたのでメモ</p>

<p><script type="math/tex; mode=display">
\begin{align}
G = \sum<em>{l=1}^{L} N</em>{l}\log \pi<em>{l} + \lambda \Bigl[ \sum</em>{l=1}^{L} \pi_{l} -1) \Bigr]
\end{align}
</script>
として、</p>

<p><script type="math/tex; mode=display">
\begin{align}
\frac{\partial G}{\partial \pi<em>{l}} = \frac{N</em>{l}}{\pi_{l}} + \lambda  =0
\end{align}
</script></p>

<p>よって、
<script type="math/tex; mode=display">
\begin{align}
\pi<em>{l} = &ndash;\frac{N</em>{l}}{\lambda}
\end{align}
</script></p>

<p>ここで、以下の制約条件に代入すると、
<script type="math/tex; mode=display">
\begin{align}
\sum<em>{l=1}^{L} \pi</em>{l} = 1
\end{align}
</script></p>

<p>$\lambda = -N$となることがわかるので、求めたかったパラメータは以下のようになる
<script type="math/tex; mode=display">
\begin{align}
\pi<em>{l} = \frac{N</em>{l}}{N}
\end{align}
</script></p>

<p>カテゴリの頻度を計算するだけ、カンタン！！</p>

<h2>参考</h2>

<ul>
<li><a href="http://en.wikipedia.org/wiki/Categorical_distribution">Categorical distribution &ndash; Wikipedia</a></li>
<li><a href="http://en.wikipedia.org/wiki/Multinomial_distribution">Multinomial distribution &ndash; Wikipedia</a></li>
<li><a href="http://d.hatena.ne.jp/nokuno/20111006/1317853653">多項分布の最尤推定 &ndash; nokunoの日記</a></li>
<li><a href="http://d.hatena.ne.jp/sleepy_yoshi/20111107/p1">多項分布の最尤推定とMAP推定 &ndash; 睡眠時間？</a></li>
<li><a href="http://lef-t.blogspot.jp/2013/02/categorical-distribution-wikipedia-free.html">Categorical distribution &ndash; Researcher&rsquo;s Eye</a></li>
</ul>

]]></content>
  </entry>
  
</feed>
